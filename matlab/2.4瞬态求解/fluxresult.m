function [] = fluxresult(h)
% 绘制flux的结果
flux = [
0.0	0.0
0.001	0.01697069442502635
0.002	0.02986015544855753
0.003	0.039973104059465754
0.004	0.04811881061681808
0.005	0.05484572353185654
0.006	0.060559343044043104
0.007	0.06558976853821
0.008	0.07020401741356987
0.009000000000000001	0.07463824582573182
0.01	0.07911917066966367
0.011	0.08387570497998803
0.012	0.08916040565424758
0.013000000000000001	0.09528143491531478
0.014	0.10266467034007211
0.015	0.11198897911246283
0.015099999999999999	0.1129437712836873
0.0152	0.11392343375433844
0.0153	0.11490939138194081
0.015399999999999999	0.1158856939141256
0.0155	0.11685091310900102
0.0165	0.12563443850498812
0.017	0.12983000849158616
0.0171	0.13066137938920236
0.0172	0.1314851976879468
0.017300000000000003	0.1323016556722546
0.017400000000000002	0.1331109398067708
0.0175	0.1339132276558156
0.018500000000000003	0.14136775734127016
0.019500000000000003	0.14833311482432923
0.02	0.15170065972729535
0.025	0.1780136038227584
0.03	0.1987219743514861
0.035	0.21485509507632938
0.04	0.22696918652578074
0.045	0.23539848305827876
0.05	0.2406910709500178
0.060000000000000005	0.24485481972253037
0.07	0.24635091752802407
0.08	0.24687837073241028
0.09	0.24706760027547192
0.1	0.24713789799929484
];
current = [
0.0	0.0
0.001	2.3431018583245513
0.002	3.7035129921562713
0.003	4.629017129697259
0.004	5.284764480882552
0.005	5.75769569498718
0.006	6.0954601626044775
0.007	6.323191501944359
0.008	6.461917041546706
0.009000000000000001	6.521923862612688
0.01	6.506358385356047
0.011	6.414488563225212
0.012	6.23843310858015
0.013000000000000001	5.959656912977607
0.014	5.53892152508088
0.015	4.891897075869749
0.015099999999999999	4.81735942925197
0.0152	4.734458431162901
0.0153	4.7134745746588225
0.015399999999999999	4.745658226050477
0.0155	4.782602683748663
0.0165	5.0721582013376345
0.017	5.20295334226795
0.0171	5.228763674612576
0.0172	5.253939004184849
0.017300000000000003	5.278473385640605
0.017400000000000002	5.302386218279251
0.0175	5.325707169850544
0.018500000000000003	5.515156771515149
0.019500000000000003	5.678214172313643
0.02	5.754970064689211
0.025	6.2458037269691316
0.03	6.619441964751484
0.035	6.924458618343782
0.04	7.192393903369898
0.045	7.438046897833466
0.05	7.6471608072173956
0.060000000000000005	7.861208374249581
0.07	7.950130073150211
0.08	7.982418226520464
0.09	7.993692348564608
0.1	7.9976567425392355
];
current_density = [
% TIME	SENSOR_1/Comp1	SENSOR_1/Comp2	SENSOR_1/Comp3	SENSOR_1/Module
0.0	0.0	0.0	0.0	0.0
0.001	0.0	0.0	1464438.6614528433	1464438.6614528433
0.002	0.0	0.0	2314695.6200976674	2314695.6200976674
0.003	0.0	0.0	2893135.706060785	2893135.706060785
0.004	0.0	0.0	3302977.8005515924	3302977.8005515924
0.005	0.0	0.0	3598559.8093669848	3598559.8093669848
0.006	0.0	0.0	3809662.6016277955	3809662.6016277955
0.007	0.0	0.0	3951994.688715222	3951994.688715222
0.008	0.0	0.0	4038698.150966688	4038698.150966688
0.009000000000000001	0.0	0.0	4076202.414132927	4076202.414132927
0.01	0.0	0.0	4066473.990847526	4066473.990847526
0.011	0.0	0.0	4009055.3520157537	4009055.3520157537
0.012	0.0	0.0	3899020.6928625903	3899020.6928625903
0.013000000000000001	0.0	0.0	3724785.5706110015	3724785.5706110015
0.014	0.0	0.0	3461825.9531755475	3461825.9531755475
0.015	0.0	0.0	3057435.6724185906	3057435.6724185906
0.015099999999999999	0.0	0.0	3010849.6432824787	3010849.6432824787
0.0152	0.0	0.0	2959036.519476811	2959036.519476811
0.0153	0.0	0.0	2945921.6091617616	2945921.6091617616
0.015399999999999999	0.0	0.0	2966036.3912815456	2966036.3912815456
0.0155	0.0	0.0	2989126.677342912	2989126.677342912
0.0165	0.0	0.0	3170098.875836019	3170098.875836019
0.017	0.0	0.0	3251845.838917466	3251845.838917466
0.0171	0.0	0.0	3267977.2966328575	3267977.2966328575
0.0172	0.0	0.0	3283711.877615528	3283711.877615528
0.017300000000000003	0.0	0.0	3299045.8660253757	3299045.8660253757
0.017400000000000002	0.0	0.0	3313991.386424529	3313991.386424529
0.0175	0.0	0.0	3328566.981156587	3328566.981156587
0.018500000000000003	0.0	0.0	3446972.9821969653	3446972.9821969653
0.019500000000000003	0.0	0.0	3548883.8576960242	3548883.8576960242
0.02	0.0	0.0	3596856.2904307535	3596856.2904307535
0.025	0.0	0.0	3903627.329355704	3903627.329355704
0.03	0.0	0.0	4137151.227969674	4137151.227969674
0.035	0.0	0.0	4327786.63646486	4327786.63646486
0.04	0.0	0.0	4495246.189606183	4495246.189606183
0.045	0.0	0.0	4648779.311145912	4648779.311145912
0.05	0.0	0.0	4779475.504510868	4779475.504510868
0.060000000000000005	0.0	0.0	4913255.233905984	4913255.233905984
0.07	0.0	0.0	4968831.2957188785	4968831.2957188785
0.08	0.0	0.0	4989011.391575286	4989011.391575286
0.09	0.0	0.0	4996057.717852876	4996057.717852876
0.1	0.0	0.0	4998535.464087018	4998535.464087018
];
force = [
%     TIME	Mechanical set / Magnetic force [MOBILE_PART] (N)
0.0	0.0
0.001	-1.3116059037378816
0.002	-4.079318530809915
0.003	-7.321320619148819
0.004	-10.605693755943726
0.005	-13.759515070476995
0.006	-16.76960481469046
0.007	-19.62536355255072
0.008	-22.43422918905451
0.009000000000000001	-25.262726571693094
0.01	-28.35379941187147
0.011	-31.97828235197797
0.012	-36.48580456393217
0.013000000000000001	-42.614502382646926
0.014	-51.87815510794497
0.015	-68.53780855915332
0.015099999999999999	-70.85846489029443
0.0152	-73.47257939742563
0.0153	-75.68669088873385
0.015399999999999999	-77.43451106993096
0.0155	-78.98168737204115
0.0165	-92.19706782654956
0.017	-98.73952931561632
0.0171	-100.05889569632939
0.0172	-101.37150717185943
0.017300000000000003	-102.67800967553043
0.017400000000000002	-103.97893188509147
0.0175	-105.27470348108235
0.018500000000000003	-117.61389632789606
0.019500000000000003	-129.73139229440616
0.02	-135.80185930687105
0.025	-188.03873341933817
0.03	-235.4179278186696
0.035	-276.27501000394784
0.04	-309.2746283809685
0.045	-333.40210137116003
0.05	-349.03137033335616
0.060000000000000005	-361.5739077407334
0.07	-366.12009613481854
0.08	-367.7161765751831
0.09	-368.2817053823675
0.1	-368.487806219027
];
position = [
%     TIME	Mechanical set / Position [MOBILE_PART] (m)
0.0	0.0
0.001	0.0
0.002	-5.246423614951526E-6
0.003	-2.6810121353142713E-5
0.004	-7.765910156792918E-5
0.005	-1.7093085680649058E-4
0.006	-3.1924067232695993E-4
0.007	-5.346289071061912E-4
0.008	-8.285185960956252E-4
0.009000000000000001	-0.0012121452018412778
0.01	-0.0016968227138737019
0.011	-0.0022949154235536117
0.012	-0.003020921262641435
0.013000000000000001	-0.003892870319984987
0.014	-0.004935277386859125
0.015	-0.006185197074165042
0.015099999999999999	-0.006312930555237999
0.0152	-0.006443498374906571
0.0153	-0.0065
0.015399999999999999	-0.0065
0.0155	-0.0065
0.0165	-0.0065
0.017	-0.0065
0.0171	-0.0065
0.0172	-0.0065
0.017300000000000003	-0.0065
0.017400000000000002	-0.0065
0.0175	-0.0065
0.018500000000000003	-0.0065
0.019500000000000003	-0.0065
0.02	-0.0065
0.025	-0.0065
0.03	-0.0065
0.035	-0.0065
0.04	-0.0065
0.045	-0.0065
0.05	-0.0065
0.060000000000000005	-0.0065
0.07	-0.0065
0.08	-0.0065
0.09	-0.0065
0.1	-0.0065
];
speed = [
%     TIME	Mechanical set / Linear Speed [MOBILE_PART] (m/s)
0.0	0.0
0.001	0.0
0.002	-0.005246423614951526
0.003	-0.02156369773819119
0.004	-0.05084898021478647
0.005	-0.09327175523856138
0.006	-0.14830981552046935
0.007	-0.2153882347792312
0.008	-0.2938896889894341
0.009000000000000001	-0.3836266057456522
0.01	-0.4846775120324245
0.011	-0.5980927096799102
0.012	-0.7260058390878222
0.013000000000000001	-0.8719490573435511
0.014	-1.0424070668741388
0.015	-1.2499196873059184
0.015099999999999999	-1.2773348107295797
0.0152	-1.3056781966856978
0.0153	-0.5650162509342922
0.015399999999999999	0.0
0.0155	0.0
0.0165	0.0
0.017	0.0
0.0171	0.0
0.0172	0.0
0.017300000000000003	0.0
0.017400000000000002	0.0
0.0175	0.0
0.018500000000000003	0.0
0.019500000000000003	0.0
0.02	0.0
0.025	0.0
0.03	0.0
0.035	0.0
0.04	0.0
0.045	0.0
0.05	0.0
0.060000000000000005	0.0
0.07	0.0
0.08	0.0
0.09	0.0
0.1	0.0
];
% 在FLUX当中对rA进行在线圈截面的面积分
% 选择integration in the domain depth
rA = [
%     TIME	SENSOR_5
0.0	0.0
0.001	5.714050319799731E-10
0.002	1.0053336300723728E-9
0.003	1.3457513170388674E-9
0.004	1.6199159495675017E-9
0.005	1.8462940767550195E-9
0.006	2.0385327542704684E-9
0.007	2.2077340548082845E-9
0.008	2.3628807012523174E-9
0.009000000000000001	2.5119115171800363E-9
0.01	2.6624431979889535E-9
0.011	2.8221630489272103E-9
0.012	2.999546367650494E-9
0.013000000000000001	3.2049263476759886E-9
0.014	3.4525704752405474E-9
0.015	3.7651996897844916E-9
0.015099999999999999	3.79720423502102E-9
0.0152	3.830036991725486E-9
0.0153	3.863128215573472E-9
0.015399999999999999	3.895938260711354E-9
0.0155	3.928382475389396E-9
0.0165	4.223643913973719E-9
0.017	4.364680338711308E-9
0.0171	4.39262744456748E-9
0.0172	4.420320619347598E-9
0.017300000000000003	4.447766290882753E-9
0.017400000000000002	4.474970713901926E-9
0.0175	4.5019398535366994E-9
0.018500000000000003	4.752515950045613E-9
0.019500000000000003	4.986644239952413E-9
0.02	5.099837854347018E-9
0.025	5.984236230288277E-9
0.03	6.680241578606093E-9
0.035	7.2224685241407125E-9
0.04	7.629637019279704E-9
0.045	7.913001552818116E-9
0.05	8.09097146913209E-9
0.060000000000000005	8.231038587965066E-9
0.07	8.281383882230397E-9
0.08	8.299136958342901E-9
0.09	8.305506980524193E-9
0.1	8.307873699045996E-9
];
% FLUX积分是选择integration in the plane
rAplane = [
%     TIME	SENSOR_6
0.0	0.0
0.001	4.321551848712034E-9
0.002	7.60382614580854E-9
0.003	1.0179067362865106E-8
0.004	1.2253354504591016E-8
0.005	1.3966348812074363E-8
0.006	1.542131007337164E-8
0.007	1.6702297406575128E-8
0.008	1.787730623404669E-8
0.009000000000000001	1.900647322699725E-8
0.01	2.0147531368653328E-8
0.011	2.135877288461223E-8
0.012	2.270451086072342E-8
0.013000000000000001	2.4263218162657755E-8
0.014	2.614334362483586E-8
0.015	2.8517759356101615E-8
0.015099999999999999	2.876089518598289E-8
0.0152	2.9010364185608103E-8
0.0153	2.92614362337874E-8
0.015399999999999999	2.951004963210796E-8
0.0155	2.975584068175853E-8
0.0165	3.1992547057029814E-8
0.017	3.3060940180958E-8
0.0171	3.327264704159538E-8
0.0172	3.348243064872295E-8
0.017300000000000003	3.369033996717007E-8
0.017400000000000002	3.3896422479768584E-8
0.0175	3.4100723402901455E-8
0.018500000000000003	3.5999003799486025E-8
0.019500000000000003	3.7772717517615577E-8
0.02	3.8630255785441146E-8
0.025	4.5330791977590947E-8
0.03	5.060413523043185E-8
0.035	5.471240068780333E-8
0.04	5.7797228744199274E-8
0.045	5.994373148009437E-8
0.05	6.129147791964418E-8
0.060000000000000005	6.235176783794513E-8
0.07	6.273274601569437E-8
0.08	6.286706087125861E-8
0.09	6.291524777871024E-8
0.1	6.29331489470854E-8
];
time = flux(:,1);
FLUX = flux(:,2);% flux当中导出的磁链
CUR = current(:,2);% FLUX当中导出的电流
% p = polyfit(time,FLUX,4);   
% pp = polyder(p);
% figure
% plot(time,FLUX,'*-');title('磁链');
% hold on
% S = 8e-3*45e-3;% 线圈面积
% phi = 2*pi*225/S*rAplane;
% plot(time,phi(:,2),'-');
% legend('FLUX','反算');
% dphidt = time;
% dphidt(1) = 24;
% % 自己计算感应电动势
% for i=2:length(time)
%     dphidt(i) = (FLUX(i)-FLUX(i-1))/(time(i)-time(i-1));
% end
% figure
% plot(time,24/3-dphidt/3,'*-');title('线圈电流');
% hold on
% plot(time,CUR,'-');
% legend('反算','FLUX');
% figure
% plot(time,speed(:,2),'*-');title('速度');
% hold on
% myspeed = time;
% myspeed(1) = 0;
% for i=2:length(time)
%     myspeed(i) = (position(i,2)-position(i-1,2))/(time(i)-time(i-1));
% end
% plot(time,myspeed,'-');
% legend('反算','FLUX');

subplot(2,3,1);hold on
plot(time,position(:,2),'*-');legend('MATLAB','FLUX');
% title('位移');
subplot(2,3,2);hold on
plot(time,speed(:,2),'*-');legend('MATLAB','FLUX');
% title('速度');
subplot(2,3,3);hold on
plot(time,force(:,2),'*-');legend('MATLAB','FLUX');
% title('电磁吸力');
subplot(2,3,4);hold on
plot(time,CUR,'*-');legend('MATLAB','FLUX');
% title('电流');
subplot(2,3,5);hold on
plot(time,FLUX,'*-');legend('MATLAB','FLUX');
% title('磁通');
% subplot(2,3,6);hold on
% plot(time,acceleration);
% title('加速度');
end